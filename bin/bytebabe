#!/bin/bash

# Resolve o diretório base do script, mesmo quando chamado via link simbólico
if [ -L "$0" ]; then
    REAL_SCRIPT_PATH=$(readlink -f "$0")
    BASE_DIR=$(dirname "$(dirname "$REAL_SCRIPT_PATH")")
else
    BASE_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)
fi

# Carrega as bibliotecas com caminhos absolutos
source "${BASE_DIR}/lib/core/colors.sh"
source "${BASE_DIR}/lib/core/helpers.sh"
source "${BASE_DIR}/lib/utils/headers.sh"

show_cyberpunk_header

# Processar comandos
case $1 in
    init)
        source "${BASE_DIR}/commands/init.sh" "${@:2}"
        ;;
    git)
        source "${BASE_DIR}/commands/git/main.sh"
        ;;
    frontend)
        source "${BASE_DIR}/commands/frontend.sh" "${@:2}"
        ;;
    backend)
        source "${BASE_DIR}/commands/backend.sh" "${@:2}"
        ;;
    servers)
        source "${BASE_DIR}/commands/servers.sh" "${@:2}"
        ;;
    db)
        source "${BASE_DIR}/commands/db.sh" "${@:2}"
        ;;
    ide)
        source "${BASE_DIR}/commands/ide.sh" "${@:2}"
        ;;
    devtools)
        source "${BASE_DIR}/commands/devtools.sh" "${@:2}"
        ;;
    docker)
        source "${BASE_DIR}/commands/docker.sh" "${@:2}"
        ;;
    *)
        echo -e "${CYBER_PINK}⚡ ByteBabe CLI ⚡${RESET}"
        echo -e "${CYBER_BLUE}Uso:"
        echo -e "  bytebabe frontend            Instala stack frontend"
        echo -e "  bytebabe backend             Instala stack backend"
        echo -e "  bytebabe ide                 Instala IDEs de desenvolvimento"
        echo -e "  bytebabe db                  Ferramentas de gerenciamento de bancos de dados"
        echo -e "  bytebabe servers             Ferramentas para gerenciamento de servidores"
        echo -e "  bytebabe devtools terminal   Configuração do terminal"
        echo -e "${RESET}"
        ;;
esac